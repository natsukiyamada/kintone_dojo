<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
		<link rel="stylesheet" type="text/css" href="./task5.css">
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<main>
  <table id="cybozuNewsTable"></table>
</main>
</body>
<script>
 'use strict';
	const getDojoData = async () => {
		let query = 'limit 10';
		await axios.get('https://54o76ppvn8.execute-api.ap-northeast-1.amazonaws.com/prod/bb-dojo',
		{params: {
			id: 'dojo',
			query: query,
		 }})
		 .then((val) =>{
			console.log(val)
			const keys = Object.keys(val.data); 
			keys.forEach((key)=>{ 
				const eachData = val.data[key]

				const tbl = document.getElementById('cybozuNewsTable') 
				const trElem = tbl.insertRow(-1);

				const cellElemForDay = trElem.insertCell(0);
				const cellElemForCategory = trElem.insertCell(1);
				const cellElemForNews = trElem.insertCell(2);
				const tdElements = [cellElemForDay,cellElemForCategory,cellElemForNews]

				for (let i = 0; i < tdElements.length; i++) { 
					
					if (tdElements[i]  === cellElemForDay) {
						tdElements[i].appendChild(document.createTextNode(`${eachData.day.value}`));
					}
					
					if (tdElements[i] === cellElemForCategory) {
						tdElements[i].appendChild(document.createTextNode(`${eachData.category.value}`));
						tdElements[i].setAttribute('class',`${eachData.label.value}`)
					}
					
					if (tdElements[i] === cellElemForNews) {
						const newsLink = document.createElement('a');
						newsLink.textContent = eachData.content.value;
						newsLink.href = eachData.url.value;		
						newsLink.target = eachData.target.value; 		
						tdElements[i].appendChild(newsLink);
					}
				}
				
			})
		 }).catch( (error) =>{ 
			console.log(error)
		 });
	}
	getDojoData();
</script>
</html>